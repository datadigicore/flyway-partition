/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.6.1/userguide/java_library_plugin.html
 */

plugins {
    // Apply the java-library plugin to add support for Java Library
    id 'pmd'
    id 'application'
    id 'io.freefair.lombok' version '5.3.0'
    id 'com.github.johnrengelman.shadow' version '6.1.0'
}

repositories {
    // Use jcenter for resolving dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

dependencies {
    // This dependency is used internally, and not exposed to consumers on their own compile classpath.
    implementation 'org.slf4j:slf4j-api:1.7.30'
    implementation 'ch.qos.logback:logback-classic:1.2.3'
    implementation 'net.logstash.logback:logstash-logback-encoder:6.6'
    implementation 'org.postgresql:postgresql:42.2.14'
    implementation 'org.flywaydb:flyway-core:7.6.0'
    implementation 'org.yaml:snakeyaml:1.28'


    // Use JUnit test framework
    testImplementation 'junit:junit:4.13'
}

pmd {
    ignoreFailures false
    consoleOutput true
    toolVersion "6.32.0"
}

application {
    mainClassName 'com.flyway.partition.App'
}

shadowJar {
    archiveBaseName.set('flyway-partition')
    archiveVersion.set('0.1.0')
    archiveClassifier.set('')
}

clean {
    delete "$projectDir/build"
}

task flywayPrtition(type: JavaExec) {
    args "staging"
    main 'com.flyway.partition.Library'
    classpath sourceSets.main.runtimeClasspath
}

jar {
    enabled false
}